{% extends "templates/web.html" %}

{% block title %}{{ _("PIM Dashboard") }}{% endblock %}

{% block head_include %}
<script>
    // Inject PIM configuration for React frontend
    window.pimConfig = {{ pim_config | tojson }};
</script>
{% endblock %}

{% block page_content %}
{% if show_dev_message %}
<div class="container mt-5">
    <div class="alert alert-info">
        <h4>{{ _("Frontend Deployed Separately") }}</h4>
        <p>{{ _("The React frontend is deployed on Vercel and communicates with this backend via API.") }}</p>
        <p class="mb-0">{{ _("This page shows the API endpoints available for the frontend application.") }}</p>
    </div>
    
    <!-- Fallback: Show basic stats while React frontend is being set up -->
    <div class="card">
        <div class="card-header">
            <h5>{{ _("PIM System Status") }}</h5>
        </div>
        <div class="card-body">
            <p>{{ _("API endpoints are ready for the React frontend:") }}</p>
            <ul>
                <li><code>/api/method/imperium_pim.api.dashboard.get_dashboard_stats</code></li>
                <li><code>/api/method/imperium_pim.api.items.get_item_list</code></li>
                <li><code>/api/method/imperium_pim.api.vendors.get_vendor_list</code></li>
                <li><code>/api/method/imperium_pim.api.attributes.get_attribute_list</code></li>
            </ul>
        </div>
    </div>
</div>
{% else %}
<!-- React app mounting point -->
<div id="root">
    <div class="d-flex justify-content-center align-items-center" style="height: 50vh;">
        <div class="spinner-border text-primary" role="status">
            <span class="sr-only">{{ _("Loading...") }}</span>
        </div>
    </div>
</div>

<!-- Load React app bundle -->
{% for js_file in js_files %}
<script type="module" src="{{ js_file }}"></script>
{% endfor %}

{% for css_file in css_files %}
<link rel="stylesheet" href="{{ css_file }}">
{% endfor %}
{% endif %}
{% endblock %}
