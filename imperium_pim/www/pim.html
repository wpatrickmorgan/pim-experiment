{% extends "templates/web.html" %}

{% block title %}{{ title }}{% endblock %}

{% block head_include %}
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{{ description }}">
    
    <!-- Include Frappe's core JavaScript first -->
    <script src="/assets/frappe/js/frappe-web.bundle.js"></script>
    
    <!-- Include React build CSS -->
    <link rel="stylesheet" href="/assets/imperium_pim/_next/static/css/81d3752c4dbd3838.css">
    
    <!-- Global configuration for the frontend app -->
    <script>
        // Ensure frappe is available globally
        window.frappe = window.frappe || {};
        
        // Global configuration for the frontend app
        window.FRAPPE_CONFIG = {
            csrf_token: frappe.csrf_token || '',
            user: frappe.session ? frappe.session.user : 'Guest',
            api_base: '/api/method/imperium_pim.api'
        };
        
        // Initialize frappe if not already done
        if (typeof frappe !== 'undefined' && frappe.ready) {
            frappe.ready(() => {
                console.log('Frappe framework loaded successfully');
            });
        }
    </script>
{% endblock %}

{% block content %}
    <!-- React app will mount here -->
    <div id="__next">
        <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh;">
            <div style="text-align: center;">
                <div style="width: 48px; height: 48px; border: 2px solid #e5e7eb; border-top: 2px solid #2563eb; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 16px;"></div>
                <p style="color: #6b7280;">Loading PIM Dashboard...</p>
            </div>
        </div>
    </div>
    
    <!-- Include the React build files -->
    <script src="/assets/imperium_pim/_next/static/chunks/webpack-7532e9e4e1841dc8.js"></script>
    <script src="/assets/imperium_pim/_next/static/chunks/main-b102c8e48da37676.js"></script>
    <script src="/assets/imperium_pim/_next/static/chunks/pages/_app-98cb51ec6f9f135f.js"></script>
    <script src="/assets/imperium_pim/_next/static/chunks/app/page-c1cf3d08d59d0acf.js"></script>
    
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
{% endblock %}
