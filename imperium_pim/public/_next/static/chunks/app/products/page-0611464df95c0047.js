(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[286],{9834:function(t,e,s){Promise.resolve().then(s.bind(s,6175)),Promise.resolve().then(s.bind(s,6512))},6512:function(t,e,s){"use strict";s.r(e),s.d(e,{ProductsTable:function(){return N}});var i=s(7437),a=s(2265),r=s(8038),n=s(9891),o=s(7470),c=s(7987),u=s(2996),h=s(300),l=class extends u.l{#t;#e=void 0;#s;#i;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#t.defaultMutationOptions(t),(0,h.VS)(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,h.Ym)(e.mutationKey)!==(0,h.Ym)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(t){this.#a(),this.#r(t)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#a(),this.#r()}mutate(t,e){return this.#i=e,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(t)}#a(){let t=this.#s?.state??(0,o.R)();this.#e={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#r(t){c.Vr.batch(()=>{if(this.#i&&this.hasListeners()){let e=this.#e.variables,s=this.#e.context;t?.type==="success"?(this.#i.onSuccess?.(t.data,e,s),this.#i.onSettled?.(t.data,null,e,s)):t?.type==="error"&&(this.#i.onError?.(t.error,e,s),this.#i.onSettled?.(void 0,t.error,e,s))}this.listeners.forEach(t=>{t(this.#e)})})}},d=s(5671),m=s(3277),x=s(575),p=s(6264),y=s(2898);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let f=(0,y.Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),g=(0,y.Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var b=s(7472),v=s(8222),j=s(2169);function N(){let[t,e]=(0,a.useState)([]),[s,o]=(0,a.useState)(""),[u,y]=(0,a.useState)(""),N=(0,r.NL)(),{data:w,isLoading:C,error:k}=(0,n.a)({queryKey:["products",{search_term:s,status:u}],queryFn:()=>v.p.getProducts({search_term:s||void 0,filters:u?{status:u}:void 0,limit:50}),staleTime:3e5}),S=function(t,e){let s=(0,r.NL)(void 0),[i]=a.useState(()=>new l(s,t));a.useEffect(()=>{i.setOptions(t)},[i,t]);let n=a.useSyncExternalStore(a.useCallback(t=>i.subscribe(c.Vr.batchCalls(t)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),o=a.useCallback((t,e)=>{i.mutate(t,e).catch(h.ZT)},[i]);if(n.error&&(0,h.L3)(i.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:o,mutateAsync:n.mutate}}({mutationFn:t=>v.p.toggleProductStar(t),onSuccess:()=>{N.invalidateQueries({queryKey:["products"]})}}),M=(null==w?void 0:w.products)||[],O=t=>{e(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},R=t=>{S.mutate(t)};return C?(0,i.jsx)(d.Zb,{children:(0,i.jsxs)(d.aY,{className:"flex items-center justify-center py-12",children:[(0,i.jsx)(p.Z,{className:"h-8 w-8 animate-spin text-gray-400"}),(0,i.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading products..."})]})}):k?(0,i.jsx)(d.Zb,{children:(0,i.jsx)(d.aY,{className:"flex items-center justify-center py-12",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("p",{className:"text-red-600 mb-2",children:"Error loading products"}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:k.message})]})})}):(0,i.jsxs)(d.Zb,{children:[(0,i.jsx)(d.Ol,{className:"pb-4",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)(d.ll,{className:"text-lg font-semibold",children:"Product Catalog"}),(0,i.jsxs)("span",{className:"text-sm text-gray-500",children:["Showing ",M.length," products",(null==w?void 0:w.total_count)&&" of ".concat(w.total_count)]})]})}),(0,i.jsx)(d.aY,{className:"p-0",children:(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"w-full",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"border-b border-gray-200 bg-gray-50",children:[(0,i.jsx)("th",{className:"w-12 px-6 py-3 text-left",children:(0,i.jsx)("input",{type:"checkbox",checked:t.length===M.length&&M.length>0,onChange:()=>{e(t=>t.length===M.length?[]:M.map(t=>t.name))},className:"rounded border-gray-300"})}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Images"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Modified"}),(0,i.jsx)("th",{className:"w-12 px-6 py-3"})]})}),(0,i.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(e=>(0,i.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsx)("input",{type:"checkbox",checked:t.includes(e.name),onChange:()=>O(e.name),className:"rounded border-gray-300"})}),(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("button",{onClick:()=>R(e.name),disabled:S.isPending,className:"p-1 hover:bg-gray-100 rounded",children:(0,i.jsx)(f,{className:"h-4 w-4 ".concat(e.is_starred?"text-yellow-400 fill-current":"text-gray-300 hover:text-yellow-400")})}),(0,i.jsx)("div",{className:"font-medium text-gray-900 text-sm",children:e.item_name})]})}),(0,i.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.item_code}),(0,i.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.item_group}),(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsx)(m.C,{variant:function(t){switch(t){case"Active":return"success";case"Draft":return"draft";case"Review":return"warning";default:return"default"}}(e.status),className:"text-xs",children:e.status})}),(0,i.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:e.stock_qty}),(0,i.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:(0,j.xG)(e.standard_rate)}),(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,i.jsx)(g,{className:"h-4 w-4 text-blue-600"}),(0,i.jsx)("span",{className:"text-sm text-blue-600",children:e.image_count})]})}),(0,i.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:(0,j.p6)(e.modified)}),(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsx)(x.z,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-gray-600",children:(0,i.jsx)(b.Z,{className:"h-4 w-4"})})})]},e.name))})]})})})]})}},7470:function(t,e,s){"use strict";s.d(e,{R:function(){return o},m:function(){return n}});var i=s(7987),a=s(9024),r=s(1640),n=class extends a.F{#n;#o;#c;constructor(t){super(),this.mutationId=t.mutationId,this.#o=t.mutationCache,this.#n=[],this.state=t.state||o(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#n.includes(t)||(this.#n.push(t),this.clearGcTimeout(),this.#o.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#n=this.#n.filter(e=>e!==t),this.scheduleGc(),this.#o.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#n.length||("pending"===this.state.status?this.scheduleGc():this.#o.remove(this))}continue(){return this.#c?.continue()??this.execute(this.state.variables)}async execute(t){let e=()=>{this.#u({type:"continue"})};this.#c=(0,r.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(Error("No mutationFn found")),onFail:(t,e)=>{this.#u({type:"failed",failureCount:t,error:e})},onPause:()=>{this.#u({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#o.canRun(this)});let s="pending"===this.state.status,i=!this.#c.canStart();try{if(s)e();else{this.#u({type:"pending",variables:t,isPaused:i}),await this.#o.config.onMutate?.(t,this);let e=await this.options.onMutate?.(t);e!==this.state.context&&this.#u({type:"pending",context:e,variables:t,isPaused:i})}let a=await this.#c.start();return await this.#o.config.onSuccess?.(a,t,this.state.context,this),await this.options.onSuccess?.(a,t,this.state.context),await this.#o.config.onSettled?.(a,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(a,null,t,this.state.context),this.#u({type:"success",data:a}),a}catch(e){try{throw await this.#o.config.onError?.(e,t,this.state.context,this),await this.options.onError?.(e,t,this.state.context),await this.#o.config.onSettled?.(void 0,e,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,e,t,this.state.context),e}finally{this.#u({type:"error",error:e})}}finally{this.#o.runNext(this)}}#u(t){this.state=(e=>{switch(t.type){case"failed":return{...e,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...e,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:t.error,failureCount:e.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}})(this.state),i.Vr.batch(()=>{this.#n.forEach(e=>{e.onMutationUpdate(t)}),this.#o.notify({mutation:this,type:"updated",action:t})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}}},function(t){t.O(0,[417,789,236,971,938,744],function(){return t(t.s=9834)}),_N_E=t.O()}]);